# DeepSpeed与llama.cpp框架预测延迟相关性分析报告

## 分析概述

本报告分析了DeepSpeed（合并Deepspeed和Deepspeed-MII）框架和llama.cpp框架下预测延迟与真实延迟的线性相关度。

## 数据概况

- **总数据量**: 4,334 行
- **分析框架**: 
  - DeepSpeed (合并): 479 个数据点 (Deepspeed: 326 + Deepspeed-MII: 153)
  - llama.cpp: 1,400 个数据点

## 主要发现

### 1. DeepSpeed框架（合并Deepspeed + Deepspeed-MII）

| 指标 | 数值 | 解释 |
|------|------|------|
| **皮尔逊相关系数** | 0.7456 | **强线性相关** |
| **斯皮尔曼相关系数** | 0.9028 | **非常强单调相关** |
| **决定系数 (R²)** | 0.4864 | 预测模型可解释48.64%的方差 |
| **均方根误差 (RMSE)** | 28.90 ms | 预测误差相对较小 |
| **平均绝对误差 (MAE)** | 8.70 ms | 平均预测偏差较小 |
| **平均绝对百分比误差 (MAPE)** | 48.89% | 相对误差中等 |

### 2. llama.cpp框架

| 指标 | 数值 | 解释 |
|------|------|------|
| **皮尔逊相关系数** | 0.2569 | **很弱线性相关** |
| **斯皮尔曼相关系数** | 0.5166 | **中等单调相关** |
| **决定系数 (R²)** | -0.1429 | 预测模型表现差于简单平均值 |
| **均方根误差 (RMSE)** | 187.46 ms | 预测误差较大 |
| **平均绝对误差 (MAE)** | 70.30 ms | 平均预测偏差较大 |
| **平均绝对百分比误差 (MAPE)** | 79.98% | 相对误差很高 |

## 框架对比分析

### 线性相关性对比

- **DeepSpeed**: 0.7456 (强相关)
- **llama.cpp**: 0.2569 (很弱相关)

**结论**: DeepSpeed框架的预测延迟与真实延迟具有强线性相关性，而llama.cpp框架的线性相关性很弱。

### 预测准确性对比

| 指标 | DeepSpeed | llama.cpp | DeepSpeed优势 |
|------|-----------|-----------|---------------|
| RMSE | 28.90 ms | 187.46 ms | **6.5倍更准确** |
| MAE | 8.70 ms | 70.30 ms | **8.1倍更准确** |
| MAPE | 48.89% | 79.98% | **1.6倍更准确** |

## 统计显著性

- **DeepSpeed**: p-value = 4.09e-86 (极其显著)
- **llama.cpp**: p-value = 1.54e-22 (显著)

两个框架的相关性都具有统计显著性，但DeepSpeed的显著性更强。

## 结论与建议

### 主要结论

1. **DeepSpeed框架表现优异**:
   - 具有强线性相关性 (r = 0.7456)
   - 预测误差相对较小
   - 模型可解释性较好 (R² = 0.4864)

2. **llama.cpp框架表现较差**:
   - 线性相关性很弱 (r = 0.2569)
   - 预测误差较大
   - 模型表现差于简单平均值 (R² < 0)

3. **整体对比**:
   - DeepSpeed在所有评估指标上都显著优于llama.cpp
   - DeepSpeed的预测准确性比llama.cpp高6-8倍

### 建议

1. **对于DeepSpeed框架**:
   - 当前预测模型表现良好，可以继续使用
   - 可以考虑进一步优化以提高R²值

2. **对于llama.cpp框架**:
   - 需要重新审视预测模型的设计
   - 建议收集更多特征或使用非线性模型
   - 考虑分层建模或集成学习方法

3. **模型改进方向**:
   - 分析llama.cpp预测失败的原因
   - 考虑硬件特性、模型大小等额外特征
   - 探索深度学习或集成学习方法

## 技术细节

- **分析方法**: 皮尔逊相关系数、斯皮尔曼相关系数
- **评估指标**: RMSE, MAE, MAPE, R²
- **数据来源**: All_results_with_predictions.csv
- **分析工具**: Python (pandas, scipy, matplotlib)

---

*报告生成时间: 2024年*
*分析脚本: correlation_analysis_frameworks_improved.py* 